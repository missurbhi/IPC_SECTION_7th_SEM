<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Review & Submit</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-gray-100">
    <div class="max-w-4xl mx-auto mt-10 p-6 bg-white shadow rounded-lg">

        <h1 class="text-3xl font-bold text-indigo-700 mb-6">Review Your FIR</h1>

        <div id="review-content" class="space-y-4 text-gray-800"></div>

        <div class="flex justify-between mt-6">
            <button onclick="goBack()" class="bg-gray-500 text-white px-5 py-2 rounded">‚Üê Back</button>

            <button onclick="submitFIR()" class="bg-green-600 text-white px-6 py-2 rounded">
                Submit FIR
            </button>
        </div>

    </div>

    <script>
        const step1 = JSON.parse(localStorage.getItem("step1"));
        const step2 = JSON.parse(localStorage.getItem("step2"));

        document.getElementById("review-content").innerHTML = `
            <p><strong>Name:</strong> ${step1.name}</p>
            <p><strong>Contact:</strong> ${step1.contact}</p>
            <p><strong>Location:</strong> ${step1.location}</p>
            <p><strong>Description:</strong> ${step2.description}</p>
            <p><strong>Predicted IPC:</strong> ${step2.ipc}</p>
        `;

        function goBack() {
            window.location.href = "/step2";
        }

        async function submitFIR() {
            const payload = {
                name: step1.name,
                contact: step1.contact,
                location: step1.location,
                description: step2.description,
                ipc: step2.ipc
            };

            const res = await fetch("/submit", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify(payload)
            });

            const data = await res.json();

            if (data.status === "success") {
                alert("FIR Submitted Successfully!");
                window.location.href = "/";
            } else {
                alert("Error: " + data.message);
            }
        }
    </script>

</body>
</html>
